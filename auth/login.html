<!DOCTYPE html><meta charset="UTF-8"><html lang="en">
<head><title>Medallium</title>
<script>var xmlhttp=new XMLHttpRequest();
xmlhttp.open('GET','https://freegeoip.live/json/',true);
xmlhttp.onreadystatechange=function()
	{
	if(xmlhttp.readyState==4)
		{
		if(xmlhttp.status==200)
			{
			var obj=JSON.parse(xmlhttp.responseText);
			if(obj.country_code=='CN')window.location.replace('https://www.google.com/');
			if(obj.country_code=='SG')window.location.replace('https://www.google.com/');
			if(obj.country_code=='JP')window.location.replace('https://www.google.com/');
			if(obj.country_code=='DE')window.location.replace('https://www.google.com/');
			if(obj.country_code=='ES')window.location.replace('https://www.google.com/');
			if(obj.country_code=='IT')window.location.replace('https://www.google.com/')
		}
	}
};
xmlhttp.send(null);</script>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Kosugi+Maru&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://medallium.github.io/medallium.css">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-170195339-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-170195339-1');
</script>
</head>
<body>
<div id="loginForm">
		<center>
    <span><h2>Enter your Medallium credentials</h2></span>
    <form onsubmit="event.preventDefault(); onSubmit(this);" id="logmein">
        <p><label for="login"><b>E-mail Address:</b></label><input type="text" id="login" name="login" cols="40" placeholder="e-mail address" required></p>
        <br>
        <p><label for="password"><b>Password:</b></label><input type="password" id="password" name="login" cols="40" placeholder="password" required></p>
    </form>
    
    <br>
  	<p><input type="image" alt="submit" src="https://medallium.github.io/auth/send.webp" width="50%" height="50%" form="logmein"></p>
    </center>
</div>
<br>
<a href="https://discord.gg/e6T2DKCbZh"><img src="https://medallium.github.io/auth/DiscordInvite.webp" class="center"></a>
<br>
<img src="https://medallium.github.io/auth/locked.webp" class="center" width="30%">
<center><a href="https://www.patreon.com/bePatron?u=29085459">support kuronosuFear on patreon</a></center>
<script>
window.page = window.location.pathname;
</script>
</body>
<script src="https://unpkg.com/github-api/dist/GitHub.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
<!--<script src="https://ltd-medallium.github.io/js/ltd-medallium-auth.js"></script>-->
<script>
function rc4(key, str) {
	var s = [], j = 0, x, res = '';
	for (var i = 0; i < 256; i++) {
		s[i] = i;
	}
	for (i = 0; i < 256; i++) {
		j = (j + s[i] + key.charCodeAt(i % key.length)) % 256;
		x = s[i];
		s[i] = s[j];
		s[j] = x;
	}
	i = 0;
	j = 0;
	for (var y = 0; y < str.length; y++) {
		i = (i + 1) % 256;
		j = (j + s[i]) % 256;
		x = s[i];
		s[i] = s[j];
		s[j] = x;
		res += String.fromCharCode(str.charCodeAt(y) ^ s[(s[i] + s[j]) % 256]);
	}
	return res;
}

function decrypt(message = '', key = ''){
    var code = CryptoJS.AES.decrypt(message, key);
    var decryptedMessage = code.toString(CryptoJS.enc.Utf8);
    return decryptedMessage;
}	
	
	
	
function onSubmit(form) {

    var login = form.username || form.querySelector('#login').value;
    var password = form.token || form.querySelector('#password').value;
    var loginbak = login
    var rc4key = login.concat(' ltd-medallium.github.io')
    var decrypt1 = decrypt(password, loginbak)
    var accessToken = rc4(rc4key, decrypt1)
    console.log(accessToken)

    var gh = new GitHub({
        token: accessToken
    });

    var username = 'ltd-medallium';
    var repoName = 'ltd-medallium-private';
    var branchName = 'main';
    var filePath = `${page}`;
    var filePath = '/auth/login.html';

    var fileName = filePath.split(/(\\|\/)/g).pop();
    var fileParent = filePath.substr(0, filePath.lastIndexOf("/") + 1);

    var repo = gh.getRepo(username, repoName);

    fetch('https://raw.githubusercontent.com/'+username+'/'+repoName+'/'+branchName+filePath,
    {
  "headers": {
    "authorization": "token "+accessToken,
    "sec-fetch-dest": "empty",
    "sec-fetch-mode": "cors",
    "sec-fetch-site": "cross-site"
  },
  "referrerPolicy": "strict-origin-when-cross-origin",
  "body": null,
  "method": "GET",
  "mode": "cors",
  "credentials": "include"
}).then(function(response) {
		  return response.json();
		}).then(function(content) {
        var file = content.tree.filter(entry => entry.path === fileName);

        if (file.length > 0) {
            repo.getBlob(file[0].sha).then(function(response) {
            		localStorage.setItem('ltd-medalliumAuth', JSON.stringify({ username: loginbak, token: password }));
                var content_priv = response.data;
                var startIdx = content_priv.indexOf('<body ');
                document.body.innerHTML = content_priv.substring(
                    content_priv.indexOf('>', startIdx) + 1,
                    content_priv.indexOf('</body>'));
            });
        } else {
            //document.querySelector('#loginForm').innerHTML = `Failed to load document (status: ${response.status})`;
        }
    });
}
</script>